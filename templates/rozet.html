<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>ZorBaRa â€“ Rozetin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
  <style>
    body { background:#f7f8fb; }
    .badge-card { max-width:640px; margin:40px auto; }
    .rozet-emoji { font-size:64px; line-height:1; }
    .muted { color:#6c757d; }
  </style>
</head>
<body>
  <div class="container">
    <div class="card p-4 badge-card text-center">
      <h2 class="mb-2">ğŸ… Rozetin</h2>
      <p class="muted mb-4">Tebrikler! ZorBaRa eÄŸitiminde hedefe ulaÅŸtÄ±n.</p>

      <div id="badgeView" class="p-4 border rounded bg-light mb-3">
        <div class="rozet-emoji" id="badge-emoji">ğŸ¥‡</div>
        <h3 id="badge-name" class="mt-2">ZorbalÄ±k AvcÄ±sÄ±</h3>
        <p class="mb-0">
          <strong>PuanÄ±n:</strong> <span id="badge-points">0</span>
        </p>
      </div>

      <div class="d-flex gap-2 justify-content-center flex-wrap">
        <button class="btn btn-warning" id="shareBtn">ğŸ”— Rozeti PaylaÅŸ</button>
        <a class="btn btn-outline-primary" href="/">ğŸ’¬ Sohbete DÃ¶n</a>
        <a class="btn btn-outline-secondary" href="/egitim">ğŸ“ EÄŸitime DÃ¶n</a>
      </div>

      <p class="muted mt-3 mb-0" id="hint"></p>
    </div>
  </div>

  <script>
    // LocalStorage'dan oku
    const pts  = Number(localStorage.getItem("zb_totalPoints") || "0");
    const badge= localStorage.getItem("zb_badge") || (pts >= 70 ? "ğŸ¥‡ ZorbalÄ±k AvcÄ±sÄ±" : "");

    // GÃ¶rÃ¼nÃ¼m doldur
    const pointsEl = document.getElementById("badge-points");
    const nameEl   = document.getElementById("badge-name");
    const emojiEl  = document.getElementById("badge-emoji");
    const hintEl   = document.getElementById("hint");

    pointsEl.textContent = pts;

    if (!badge) {
      // Hedefe ulaÅŸmamÄ±ÅŸsa bilgilendir
      emojiEl.textContent = "ğŸ¯";
      nameEl.textContent  = "HenÃ¼z rozet kazanmadÄ±n";
      hintEl.textContent  = "70+ puana ulaÅŸtÄ±ÄŸÄ±nda rozetin burada gÃ¶rÃ¼necek. Devam! ğŸš€";
      document.getElementById("shareBtn").disabled = true;
    } else {
      nameEl.textContent = badge.replace("ğŸ¥‡ ", "");
      emojiEl.textContent = badge.startsWith("ğŸ¥‡") ? "ğŸ¥‡" : (badge.startsWith("ğŸ¥ˆ") ? "ğŸ¥ˆ" : "ğŸ¥‰");
      hintEl.textContent  = "Harika iÅŸ Ã§Ä±kardÄ±n! Dilersen rozetini paylaÅŸabilirsin. ğŸ™Œ";
    }

    // PaylaÅŸ
    const shareBtn = document.getElementById("shareBtn");
    shareBtn.onclick = () => {
      const txt = `ZorBaRa EÄŸitim ModÃ¼lÃ¼nÃ¼ tamamladÄ±m! PuanÄ±m: ${pts}. Rozetim: ${badge || "â€”"} #ZorBaRa #SiberZorbalÄ±k`;
      if (navigator.share) {
        navigator.share({ text: txt }).catch(() => copy(txt));
      } else {
        copy(txt);
      }
    };

    function copy(t){
      navigator.clipboard.writeText(t).then(()=>{
        alert("PaylaÅŸÄ±m metni panoya kopyalandÄ±. Sosyal medyada yapÄ±ÅŸtÄ±rabilirsin! âœ…");
      });
    }
  </script>
</body>
</html>
